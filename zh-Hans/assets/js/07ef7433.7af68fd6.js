"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8658],{28453:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>d});var s=o(96540);const r={},i=s.createContext(r);function t(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(i.Provider,{value:n},e.children)}},73857:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"programming-and-tools/development/docker/docker-without-sudo","title":"Docker without sudo","description":"Configuration method for running Docker commands without sudo","source":"@site/docs/2-programming-and-tools/development/docker/docker-without-sudo.md","sourceDirName":"2-programming-and-tools/development/docker","slug":"/programming-and-tools/development/docker/docker-without-sudo","permalink":"/zh-Hans/docs/programming-and-tools/development/docker/docker-without-sudo","draft":false,"unlisted":false,"editUrl":"https://github.com/youkoutaku/docusaurus-youkoutaku/tree/main/docs/2-programming-and-tools/development/docker/docker-without-sudo.md","tags":[{"inline":true,"label":"Docker","permalink":"/zh-Hans/docs/tags/docker"},{"inline":true,"label":"Linux","permalink":"/zh-Hans/docs/tags/linux"},{"inline":true,"label":"Security","permalink":"/zh-Hans/docs/tags/security"},{"inline":true,"label":"User Management","permalink":"/zh-Hans/docs/tags/user-management"}],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Docker without sudo","description":"Configuration method for running Docker commands without sudo","tags":["Docker","Linux","Security","User Management"],"authors":"youkoutaku"},"sidebar":"tutorialSidebar","previous":{"title":"Start a Docker Container","permalink":"/zh-Hans/docs/programming-and-tools/development/docker/docker-container-start"},"next":{"title":"Docker Command Reference","permalink":"/zh-Hans/docs/programming-and-tools/development/docker/docker-commands"}}');var r=o(74848),i=o(28453);const t={sidebar_position:3,title:"Docker without sudo",description:"Configuration method for running Docker commands without sudo",tags:["Docker","Linux","Security","User Management"],authors:"youkoutaku"},d="Docker without sudo",c={},l=[{value:"Why sudo is Required",id:"why-sudo-is-required",level:2},{value:"Steps to Use Docker without sudo",id:"steps-to-use-docker-without-sudo",level:2},{value:"1. Create Docker Group",id:"1-create-docker-group",level:3},{value:"2. Add User to Docker Group",id:"2-add-user-to-docker-group",level:3},{value:"Alternative Method",id:"alternative-method",level:4},{value:"3. Apply Group Changes",id:"3-apply-group-changes",level:3},{value:"4. Test Configuration",id:"4-test-configuration",level:3},{value:"Additional Verification Commands",id:"additional-verification-commands",level:2},{value:"Check Docker Status",id:"check-docker-status",level:3},{value:"Detailed Permission Check",id:"detailed-permission-check",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"1. &quot;permission denied&quot; Error",id:"1-permission-denied-error",level:4},{value:"2. Group Changes Not Applied",id:"2-group-changes-not-applied",level:4},{value:"3. Docker Daemon Won&#39;t Start",id:"3-docker-daemon-wont-start",level:4},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Important Notes",id:"important-notes",level:3},{value:"Guidelines for Safe Usage",id:"guidelines-for-safe-usage",level:3},{value:"Docker Rootless Mode",id:"docker-rootless-mode",level:3},{value:"References",id:"references",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"docker-without-sudo",children:"Docker without sudo"})}),"\n",(0,r.jsx)(n.p,{children:"By default, Docker commands require root privileges (sudo) to execute. However, with proper configuration, regular users can run Docker commands without sudo."}),"\n",(0,r.jsx)(n.h2,{id:"why-sudo-is-required",children:"Why sudo is Required"}),"\n",(0,r.jsx)(n.p,{children:"The Docker daemon binds to a Unix socket, which is owned by the root user by default. Therefore, the Docker CLI requires root privileges to communicate with the daemon."}),"\n",(0,r.jsx)(n.h2,{id:"steps-to-use-docker-without-sudo",children:"Steps to Use Docker without sudo"}),"\n",(0,r.jsx)(n.h3,{id:"1-create-docker-group",children:"1. Create Docker Group"}),"\n",(0,r.jsxs)(n.p,{children:["Create the ",(0,r.jsx)(n.code,{children:"docker"})," group. Users in this group can run Docker commands without root privileges."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo groupadd docker\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"If Group Already Exists",type:"info",children:(0,r.jsx)(n.p,{children:"If the group already exists, this command will have no effect."})}),"\n",(0,r.jsx)(n.h3,{id:"2-add-user-to-docker-group",children:"2. Add User to Docker Group"}),"\n",(0,r.jsxs)(n.p,{children:["Add the current user to the ",(0,r.jsx)(n.code,{children:"docker"})," group:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo gpasswd -a $USER docker\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Specifying Username",type:"tip",children:(0,r.jsxs)(n.p,{children:["To add other users, replace ",(0,r.jsx)(n.code,{children:"$USER"})," with the appropriate username."]})}),"\n",(0,r.jsx)(n.h4,{id:"alternative-method",children:"Alternative Method"}),"\n",(0,r.jsxs)(n.p,{children:["You can also use the ",(0,r.jsx)(n.code,{children:"usermod"})," command:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo usermod -aG docker $USER\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-apply-group-changes",children:"3. Apply Group Changes"}),"\n",(0,r.jsxs)(n.p,{children:["To apply group changes without logging out and back in, use the ",(0,r.jsx)(n.code,{children:"newgrp"})," command:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"newgrp docker\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"About Session Changes",type:"warning",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"newgrp"})," command is only effective for the current session. To fully apply the settings, we recommend logging out and back in or restarting the system."]})}),"\n",(0,r.jsx)(n.h3,{id:"4-test-configuration",children:"4. Test Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Verify that Docker works without sudo:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"docker run hello-world\n"})}),"\n",(0,r.jsx)(n.p,{children:"If successful, you'll see a message like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Hello from Docker!\nThis message shows that your installation appears to be working correctly.\n...\n"})}),"\n",(0,r.jsx)(n.h2,{id:"additional-verification-commands",children:"Additional Verification Commands"}),"\n",(0,r.jsx)(n.h3,{id:"check-docker-status",children:"Check Docker Status"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check Docker daemon status\ndocker info\n\n# Check Docker version\ndocker version\n\n# Check current user's groups\ngroups\n"})}),"\n",(0,r.jsx)(n.h3,{id:"detailed-permission-check",children:"Detailed Permission Check"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check Docker socket permissions\nls -la /var/run/docker.sock\n\n# Check current user ID\nid\n"})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,r.jsx)(n.h4,{id:"1-permission-denied-error",children:'1. "permission denied" Error'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"docker: Got permission denied while trying to connect to the Docker daemon socket\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verify user is added to docker group"}),"\n",(0,r.jsx)(n.li,{children:"Log out and log back in"}),"\n",(0,r.jsx)(n.li,{children:"Check if Docker service is running"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check group membership\ngroups | grep docker\n\n# Check Docker service status\nsudo systemctl status docker\n\n# Start Docker service\nsudo systemctl start docker\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-group-changes-not-applied",children:"2. Group Changes Not Applied"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solution:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Completely log out and log back in"}),"\n",(0,r.jsx)(n.li,{children:"Restart the system"}),"\n",(0,r.jsx)(n.li,{children:"Force application with these commands:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo systemctl restart docker\nnewgrp docker\n"})}),"\n",(0,r.jsx)(n.h4,{id:"3-docker-daemon-wont-start",children:"3. Docker Daemon Won't Start"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Enable Docker service\nsudo systemctl enable docker\n\n# Check detailed service status\nsudo journalctl -u docker.service\n"})}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"important-notes",children:"Important Notes"}),"\n",(0,r.jsxs)(n.admonition,{title:"Security Risk",type:"danger",children:[(0,r.jsx)(n.p,{children:"Members of the docker group have effectively root-equivalent privileges. This is because:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Host Filesystem Access"}),": Containers can mount the host filesystem"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Privilege Escalation Potential"}),": Can run privileged containers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"System Resource Access"}),": Control over network, processes, etc."]}),"\n"]})]}),"\n",(0,r.jsx)(n.h3,{id:"guidelines-for-safe-usage",children:"Guidelines for Safe Usage"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Add Only Trusted Users"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Add only necessary users to docker group\nsudo gpasswd -a trusted_user docker\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Regular Permission Review"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check docker group members\ngetent group docker\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Consider Alternatives"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Podman"}),": Docker alternative with rootless execution capability"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Docker Rootless Mode"}),": Available in Docker 20.10+"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"docker-rootless-mode",children:"Docker Rootless Mode"}),"\n",(0,r.jsx)(n.p,{children:"Consider using Docker Rootless Mode as a safer alternative:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Install Rootless Docker\ncurl -fsSL https://get.docker.com/rootless | sh\n\n# Set environment variables\nexport PATH=$HOME/bin:$PATH\nexport DOCKER_HOST=unix://$XDG_RUNTIME_DIR/docker.sock\n"})}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/engine/install/linux-postinstall/",children:"Docker Official Documentation - Post-installation steps"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/engine/security/rootless/",children:"Docker Rootless Mode"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://askubuntu.com/questions/477551/how-can-i-use-docker-without-sudo",children:"Ask Ubuntu - How can I use docker without sudo?"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);